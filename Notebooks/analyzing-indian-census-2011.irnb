{"cells":[{"metadata":{"_execution_state":"idle","_uuid":"1027b308bd1ba2e955272e961d96e92a29d9e033","_cell_guid":"333262db-14de-462e-afe7-8a2be2f1c3da"},"cell_type":"markdown","source":" **2011 Census Story Narration**"},{"metadata":{"_uuid":"c5c68332ce76acf24fc371ae6ffad24788de848e","_cell_guid":"582d3021-163f-45e8-8ca8-452e87c37b18"},"cell_type":"markdown","source":"##### **Importing Libraries to work on Data**"},{"metadata":{"_uuid":"5f356ad51de22355d102a236651d015708d36f3b","trusted":true,"_cell_guid":"c4b80b85-aeca-4d78-9d7f-237505b9e83d"},"cell_type":"code","source":"# This R environment comes with all of CRAN preinstalled, as well as many other helpful packages\n# The environment is defined by the kaggle/rstats docker image: https://github.com/kaggle/docker-rstats\n# For example, here's several helpful packages to load in \n\nlibrary(ggplot2) # Data visualization\nlibrary(readr) # CSV file I/O, e.g. the read_csv function\nlibrary(tidyr)\nlibrary(dplyr)\nlibrary(stringr)\nlibrary(reshape2)\nlibrary(scales)\nlibrary(corrplot)","execution_count":6,"outputs":[]},{"metadata":{"_uuid":"4f799e6481172bbfafcc83535f1c6b6a5b782cee","trusted":true,"_cell_guid":"ee12bce0-65c0-4c71-b814-796e4a730c12"},"cell_type":"code","source":"# Input data files are available in the \"../input/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nlist.files(\"../input\")\n\n# Any results you write to the current directory are saved as output.","execution_count":null,"outputs":[]},{"metadata":{"_uuid":"ea3b01b82ec7dae26c5199acf7e38629c0ced133","trusted":true,"_cell_guid":"6634c76c-2404-4430-8977-f7c599c5449c"},"cell_type":"code","source":"#import data from csv to data frame\ncity_data <- read.csv(\"../input/cities_r2.csv\",  stringsAsFactors = F)","execution_count":2,"outputs":[]},{"metadata":{"_uuid":"ece1c14f6168dc4a0cfdba5d2dae6dfb7b25cf48","trusted":true,"_cell_guid":"8b104026-6791-4f95-9999-4551d3614f1f"},"cell_type":"code","source":"#Structure of Imported Data\nstr(city_data)","execution_count":null,"outputs":[]},{"metadata":{"_uuid":"3bdcd069f0298db37e92b5b1342725198fe82c90","trusted":true,"_cell_guid":"dda7c189-6446-4970-87bc-2d0cea519d5f"},"cell_type":"code","source":"#Summary of Imported Data\nsummary(city_data)\n#First glance doesn't pointout any wierd data\n#StateCode is 35 Need to find how many unique states are there. Does this result also contain the Union Territories?","execution_count":null,"outputs":[]},{"metadata":{"_uuid":"4ae11c7a8a590494d628db355bde709e6bbfc3c3","trusted":true,"_cell_guid":"20d6a05e-78ef-4811-a137-7b6c29c1ac2b"},"cell_type":"code","source":"#check how many duplicated cities are there\ncity_name = city_data$name_of_city[which(duplicated(city_data$name_of_city))]\n#Find the duplicate entries\ncity_data %>% filter(name_of_city==city_name)","execution_count":null,"outputs":[]},{"metadata":{"scrolled":false,"_uuid":"9d11c50a2ea771873498d17863fd17b0334f5672","trusted":true,"_cell_guid":"b67c3b44-57a3-4f54-9a4f-ce3fb4b3afb5"},"cell_type":"code","source":"sum(is.na(city_data)) #No empty record\n\nhead(city_data)\n\ncolnames(city_data)\n#name_of_city' 'state_code' 'state_name' 'dist_code' 'population_total' 'population_male' 'population_female' 'X0.6_population_total' 'X0.6_population_male' \n#'X0.6_population_female' 'literates_total' 'literates_male' 'literates_female' 'sex_ratio' 'child_sex_ratio' 'effective_literacy_rate_total' 'effective_literacy_rate_male' \n#'effective_literacy_rate_female' 'location' 'total_graduates' 'male_graduates' 'female_graduates'","execution_count":null,"outputs":[]},{"metadata":{"scrolled":true,"_uuid":"60d3a9ff4d33f2a8d36dfb6cdbfe7151a91a4bf0","trusted":true,"_cell_guid":"491b3000-917f-4615-99f2-3c6e7f42c9f8"},"cell_type":"code","source":"#replace the extra spoace in cities\ncity_data$name_of_city #Few cities have space in their names. Will replace it for easy use.\ncity_data$name_of_city <- gsub(\" \", \"\", city_data$name_of_city)","execution_count":3,"outputs":[]},{"metadata":{"_uuid":"30883aed2d4ec81086e85f87e6c4df4620ad70cd","trusted":true,"_cell_guid":"28f4c878-d2e8-488d-92eb-5901f3cc4b1a"},"cell_type":"code","source":"length(unique(city_data$state_code)) #Total 29 states codes and \nlength(unique(city_data$state_name)) #Total 29 unique state names\n\nnrow(unique(city_data[,c(\"state_code\", \"state_name\")])) #29 Indicates there are unique code given to each state name\nunique(city_data[,c(\"state_code\", \"state_name\")])\n#No empty data recieved and hence no need to check for na or empty\n#Lets convert this to factor for easier analysis going ahead\ncity_data$state_code <- as.factor(city_data$state_code)\ncity_data$state_name <- as.factor(city_data$state_name)","execution_count":4,"outputs":[]},{"metadata":{"_uuid":"979bca87f1f889dd41271e7eaf59e0a7dbf08bce","trusted":true,"_cell_guid":"5bdf751b-ef5e-404b-aaa8-f396f52793f3"},"cell_type":"code","source":"#Districts Analysis\nlength(unique(city_data$dist_code)) \nsort(unique(city_data$dist_code)) #Not continuous 1-99 codes\nsum(is.na(city_data$dist_code)) #no empty\ncity_data$dist_code <- as.factor(city_data$dist_code)","execution_count":5,"outputs":[]},{"metadata":{"scrolled":true,"_uuid":"b0f68532e00f6e6d35827af43f9886ec5e63dadd","trusted":true,"_cell_guid":"b7dbe97a-79c3-431a-abb4-31404114c219"},"cell_type":"code","source":"#No of cities for each dist_code in each state.\ntemp = city_data %>% group_by(state_code, state_name, dist_code) %>% summarise(total_cities = n()) %>% arrange(total_cities)\n#In one district there are 22 maximum cities considered for westbengal's district 22\n\nggplot(temp, aes(dist_code, total_cities, fill=state_name)) + geom_bar(stat = \"identity\") + \n  theme(axis.text.x = element_text(angle = 60, hjust = 1), legend.position = \"none\") +\n  geom_text(aes(label=total_cities), stat = \"identity\", vjust=-0.35) + \n  labs(x=\"State\", y=\"Count\", title=\"Number of Cities choosed from each State and district\", \n       caption=paste(\"Total number of Cities considered =\", sum(state_df$total_cities)))","execution_count":null,"outputs":[]},{"metadata":{"scrolled":true,"_execution_state":"idle","_uuid":"e2981aadefd20a63cb7463e57d38866b053ef992","trusted":true,"_cell_guid":"a2d364ee-0a9e-41dd-ba09-1cacce599a6a"},"cell_type":"code","source":"##Treat the outliers from beginning\n#Consider the total population will have the outlier\n#we will exclude the outlier and maybe later we will analize them separately\n#finding the 1st and 3rd quantiles\nquantiles <- quantile(city_data$population_total,c(0.25,0.75))\nquantiles\n\n#creating a range which could be tolerated\n\nrange <- 1.5*IQR(city_data$population_total)\nrange\n\n#Filtering lower outliers if any\nlower_outliers <- city_data[which(city_data$population_total < (quantiles[1] - range)),]\nnrow(lower_outliers) #Nothing is an lower bound outlier\n#removing it from data set\nif(nrow(lower_outliers)!=0) {\n  without_outlier_data <- city_data[-which(city_data$population_total < (quantiles[1] - range)),]\n}\n\n#finding the upper putliers\nupper_outliers <- city_data[which(city_data$population_total > (quantiles[2] + range)),]\nnrow(upper_outliers) #61 entries that are upper bound outlier\n#removing it from data set\nif (nrow(upper_outliers)!=0) {\n  without_outlier_data <- without_outlier_data[-which(city_data$population_total > (quantiles[2] + range)),]\n}\n#We will consider Outliers separately","execution_count":null,"outputs":[]},{"metadata":{"_uuid":"a381e4be8c8cf79079c543c86e9b99b066dd1f61","_cell_guid":"c098837c-60d8-4f5d-8a1e-191354843e8c"},"cell_type":"markdown","source":"##### Lets aggregate the data at city level #####"},{"metadata":{"scrolled":true,"_execution_state":"idle","_uuid":"bc35dfc4645dd28de2949ebb60294d8718b7bcfd","trusted":true,"_cell_guid":"5caa7b85-eeda-435f-9f95-08ce8b631110"},"cell_type":"code","source":"#Aggregate Data on State Level\nstate_df <- city_data %>% group_by(state_code, state_name) %>% summarise(total_cities = n(),\n                                                                         total_population = sum(population_total), \n                                                                         male_population = sum(population_male),\n                                                                         female_population = sum(population_female),\n                                                                            state_sex_ratio = round((female_population/male_population)*1000,0),\n                                                                            child_population = sum(X0.6_population_total),\n                                                                            male_child_population=sum(X0.6_population_male),\n                                                                            female_child_population=sum(X0.6_population_female),\n                                                                            state_Child_sex_ratio = round((female_child_population/male_child_population)*1000,0),\n                                                                            total_literates = sum(literates_total),\n                                                                            male_literates = sum(literates_male),\n                                                                            female_literates = sum(literates_female),\n                                                                            effective_literacy_rate = round((total_literates/total_population)*100,1),\n                                                                            male_effective_literacy_rate = round((male_literates/total_population)*100,1),\n                                                                            female_effective_literacy_rate = round((female_literates/total_population)*100,1),\n                                                                            graduates_total = sum(total_graduates),\n                                                                            graduates_male = sum(male_graduates),\n                                                                            graduates_female = sum(female_graduates),\n                                                                            total_graduation_rate = round((graduates_total/total_population)*100,2),\n                                                                            male_graduation_rate = round((graduates_male/male_population)*100,2),\n                                                                            female_graduation_rate = round((graduates_female/female_population)*100,2)) %>% arrange(desc(total_population))","execution_count":7,"outputs":[]},{"metadata":{"_uuid":"d53e26c9eac6f014df402b5179acfc4973ccd6ef","trusted":true,"_cell_guid":"7327791a-385c-4ce7-aeba-73f09a0dbf63"},"cell_type":"code","source":"## Ploting the Number of cities for which data has been collected ##\n### excluding the cities which were outliers ###\nggplot(state_df, aes(reorder(state_name, total_cities, desc), total_cities, fill=state_name)) + geom_bar(stat = \"identity\") + \n  theme(axis.text.x = element_text(angle = 60, hjust = 1), legend.position = \"none\") +\n  geom_text(aes(label=total_cities), stat = \"identity\", vjust=-0.35) + \n  labs(x=\"State\", y=\"Count\", title=\"Number of Cities choosed from each State\", \n       caption=paste(\"Total number of Cities considered =\", sum(state_df$total_cities)))\n\n### From this it is clear that for West Bengal most number of cities were covered\n### Where as for north east states 3 or lesser number of cities were covered ###","execution_count":null,"outputs":[]},{"metadata":{"_execution_state":"idle","_uuid":"b5399b226dc734e487056075a67cae62fa0ec634","trusted":true,"_cell_guid":"e5eb53d8-34a1-4cdb-9cd4-74af7c14c6ac"},"cell_type":"code","source":"## Plots for Population in States ##\n### Filter Poplation Data from the aggregated data ###\npopulation_data <- melt(state_df[, c(\"state_name\", \"total_population\", \"male_population\", \"female_population\")], id=\"state_name\")\n\nggplot(population_data, aes(state_name, value/10^6, col=variable)) + \n  theme(axis.text.x = element_text(angle = 90, hjust = 1), legend.position=\"bottom\") +\n  geom_line(aes(group=variable)) + geom_point(alpha=0.3) +\n  labs(x=\"State\", y=\"Population in Millions\", title=\"Total, Male and Female Population in Each State\")\n\n#Standardize the numbers\nstate_df$total_population <- 100*state_df$total_population/sum(state_df$total_population)\nstate_df$male_population <- 100*state_df$male_population/sum(state_df$male_population)\nstate_df$female_population <- 100*state_df$female_population/sum(state_df$female_population)\npopulation_data <- melt(state_df[, c(\"state_name\", \"total_population\", \"male_population\", \"female_population\")], id=\"state_name\")\n\n### Ploting population in each state ###\nggplot(population_data, aes(state_name, value, col=variable)) + \n  theme(axis.text.x = element_text(angle = 90, hjust = 1), legend.position=\"bottom\") +\n  geom_line(aes(group=variable)) + geom_point(alpha=0.3) +\n  labs(x=\"State\", y=\"Population in %\", title=\"Total, Male and Female Population in Each State\")\n\n### From the chart we can see that the population is highest in Maharastra followed by Uttar Pradesh\n### This seems to be because of the number of cities covered as they also follow the same trend ###\n\n\n### Ploting sex ratio for each state\nggplot(state_df, aes(reorder(state_name, state_sex_ratio, desc), state_sex_ratio, fill=state_name)) + \n  theme(axis.text.x = element_text(angle = 60, hjust = 1), legend.position=\"none\") + geom_bar(stat=\"identity\") +\n  geom_text(aes(label=state_sex_ratio), stat = \"identity\",hjust=0, angle=90) +\n  labs(x=\"State\", y=\"Sex Ratio of Population\", title=\"Sex Ratio of Population in each State\")\n\n### sex ratio is given by total female for each 1000 male which also indicates the female to male ratio in\n### a state.\n### Kerala has maximum results with 1063 while Himachal Pradesh has the worst 818\n### Tripura, Mizoram, Puducherry, Meghalaya, Manipur and Kerla are doing well\n### Rest other needs to catch up 1000 number where 1:1 ratio can be maintained ###","execution_count":null,"outputs":[]},{"metadata":{"_execution_state":"idle","_uuid":"28f13bb7ca9c7d83d05312155cfa10e64345406e","trusted":true,"_cell_guid":"8b2f3775-2d89-4ddb-bfec-a730a3128935"},"cell_type":"code","source":"## Plot for Child Population study in states ##\n### Filter Child Poplation Data from the aggregated data ###\nchild_population_data <- melt(state_df[, c(\"state_name\", \"child_population\", \"male_child_population\", \"female_child_population\")], id=\"state_name\")\n\n### Ploting child population in each state ###\nggplot(child_population_data, aes(state_name, value/(10^6), col=variable)) + \n  theme(axis.text.x = element_text(angle = 90, hjust = 1), legend.position=\"bottom\") + \n  geom_line(aes(group=variable)) + geom_point(alpha=0.3) +\n  labs(x=\"State\", y=\"Child Population in Million\", title=\"Total, Male and Female Child Population in Each State\")\n\n\nstate_df$child_population <- 100*state_df$child_population/sum(state_df$child_population)\nstate_df$male_child_population <- 100*state_df$male_child_population/sum(state_df$male_child_population)\nstate_df$female_child_population <- 100*state_df$female_child_population/sum(state_df$female_child_population)\n\nchild_population_data <- melt(state_df[, c(\"state_name\", \"child_population\", \"male_child_population\", \"female_child_population\")], id=\"state_name\")\n\n### Ploting child population in each state ###\nggplot(child_population_data, aes(state_name, value, col=variable)) + \n  theme(axis.text.x = element_text(angle = 90, hjust = 1), legend.position=\"bottom\") + \n  geom_line(aes(group=variable)) + geom_point(alpha=0.3) +\n  labs(x=\"State\", y=\"Child Population in %\", title=\"Total, Male and Female Child Population in Each State\")\n\n### From the chart we can see that the population is highest in uttar pradesh followed by west bengal\n### and maharastra\n\n\n### Ploting sex ratio for each state\nggplot(state_df, aes(reorder(state_name, state_Child_sex_ratio, desc), state_Child_sex_ratio, fill=state_name)) + \n  theme(axis.text.x = element_text(angle = 60, hjust = 1), legend.position=\"none\") + geom_bar(stat=\"identity\") +\n  geom_text(aes(label=state_Child_sex_ratio), stat = \"identity\",hjust=0, angle=90) +\n  labs(x=\"State\", y=\"Sex Ratio of Child Population\", title=\"Sex Ratio of Child Population in each State\")\n\n### sex ratio is given by total female for each 1000 male which also indicates the female to male ratio in\n### a state.\n### Mizoram has maximum results with 989 followed by Puducherry while Haryana has the worst 819\n### Here it is clearly shows that none of the sates have female population more than 50% which is a reason of concern.###\n","execution_count":null,"outputs":[]},{"metadata":{"_execution_state":"idle","_uuid":"a8f51d71af6815fd49b2e24b744edf81458033c3","trusted":true,"_cell_guid":"88c90712-c02c-4924-9abc-8a29a745c6ef"},"cell_type":"code","source":"## Graph expplaining the population with respect to education ##\n\nliteracy_data <- melt(state_df[, c(\"state_name\", \"total_literates\", \"male_literates\", \"female_literates\")], id=\"state_name\")\n\n### Plot showing the literate total, male and female population in each state ###\nggplot(literacy_data, aes(state_name, value/(10^6), col=variable)) + \ngeom_line(aes(group=variable)) + geom_point(alpha=0.3) +\n  theme(axis.text.x = element_text(angle = 60, hjust = 1), legend.position = \"bottom\") +\n  labs(x=\"State\", y=\"Literate Population in Million\", title=\"Literate Population in States\") \n\n### From the plot we can say the number of literates are high in West Bengal Followed by Uttar Pradesh\n### while the lowest is in Andaman & nicobar Islands and Mizoram. Here the number of cities considered\n### might also be a factor in such results. ###\n\n### Plot showing the female to male literates ratio in each state ###\nggplot(state_df, aes(state_name, round((female_literates/male_literates),2), fill=state_name)) + geom_bar(stat = \"identity\", position = position_dodge(width = 0.5), alpha=0.8) +\n  geom_text(label=round((state_df$female_literates/state_df$male_literates),2), angle=90, hjust=0) +\n  theme(axis.text.x = element_text(angle = 60, hjust = 1), legend.position = \"none\") +\n  labs(x=\"State\", y=\"Female to Male\\nLiterate population\", title=\"Female Literate to Male Literate population in States\")\n\n### For this if the result is 1 that means there are equal number of male and female literates. While if the number is more the \n### number of female literates are more than male and vice versa. So for states Kerala, Meghalaya and Mizoram where the population \n### was not significant the number of female literates are more than male literates. In other states it is the other way round.\n### the state NCT of Delhi has the worst literate ratio followed by Rajasthan and Bihar.","execution_count":null,"outputs":[]},{"metadata":{"_execution_state":"idle","_uuid":"d13c06f00428d423c681b25f40174904af1c9d9c","trusted":true,"_cell_guid":"63b0294a-6260-458b-a672-72916cce8cdc"},"cell_type":"code","source":"## Graph expplaining the population literacy with respect to total population ##\n\nliteracy_rate_data <- melt(state_df[, c(\"state_name\", \"effective_literacy_rate\", \"male_effective_literacy_rate\", \"female_effective_literacy_rate\")], id=\"state_name\")\n\n### to get clear picture of the literacy we need to see the percentage of population ###\nggplot(state_df, aes(reorder(state_name, effective_literacy_rate, desc), effective_literacy_rate, fill=state_name)) +\n  geom_bar(stat = \"identity\", position = position_dodge(width = 0.5), alpha=0.8) +\n  theme(axis.text.x = element_text(angle = 60, hjust = 1), legend.position = \"none\") +\n  geom_text(aes(label=effective_literacy_rate), stat = \"identity\", hjust=0, angle=90) +\n  labs(x=\"State\", y=\"Literate rate of population\", title=\"Literate Rate of Total Population in States\")\n\n### from above graph we can tell that Kerala tops the literacy rate with 87.6% while the 2 staes Uttar Pradesh and Bihar are almost equal\n### and lowest in literacy rate at 69.75%\n\n### Plot to see the percentage of total, male and female literacy rate for each state ###\nggplot(literacy_rate_data, aes(state_name, value, col=variable)) + geom_line(aes(group = variable)) + geom_point() +\n  theme(axis.text.x = element_text(angle = 90, hjust = 1), legend.position = \"bottom\") +\n  labs(x=\"State\", y=\"Literate rate of population\", title=\"Literate Rate of Total Population, Male and Female Population in States\")\n\n### from this graph we can tell that the females of Bihar are lagging most and female from Kerala are ahead of eveey other state females\n### Himachal Pradesh males seems to be leading all other states male and female while uttar pradesh males seems to have least literacy rate ###\n","execution_count":null,"outputs":[]},{"metadata":{"_execution_state":"idle","_uuid":"68f104264caffbdf7b41979545b1ea3ccb399edb","trusted":true,"_cell_guid":"64559678-d7c9-44a6-a843-fee3e3e913e4"},"cell_type":"code","source":"##It is important to see how the female to male ratio effect the literacy rate of state ##\n## Filter data to show relationship between sex ratio and literacy rate ##\nsex_ratio_vs_literacy_rate_data <- melt(state_df[, c(\"state_name\", \n                                                     \"state_sex_ratio\",\n                                                     \"effective_literacy_rate\", \n                                                     \"male_effective_literacy_rate\", \n                                                     \"female_effective_literacy_rate\")], \n                                        id=\"state_name\")\n\n\n### Bring the sex ratio to a comparable value ###\nsex_ratio_vs_literacy_rate_data[sex_ratio_vs_literacy_rate_data$variable==\"state_sex_ratio\",]$value <-\n  sex_ratio_vs_literacy_rate_data[sex_ratio_vs_literacy_rate_data$variable==\"state_sex_ratio\",]$value/10\n\n### Plot the relation between sex ratio and literacy rate for each state ###\nggplot(sex_ratio_vs_literacy_rate_data, aes(state_name, value, col=variable)) + \n  geom_line(aes(group = variable)) + geom_point()  +\n  theme(axis.text.x = element_text(angle = 90, hjust=1), legend.position = \"bottom\") +\n  labs(x=\"Sex Ratio\", y=\"Literate rate\", title=\"Sex Ratio vs Literate Rate in States\")\n\n### From the graph it can be seen that thought the sex ratio in Himachal Pradesh is really bad (The lowest)\n### The lteracy rate is really high (The highest). Similarly there is another interesting state AndhraPradesh\n### where the sex ratio is about 100 but the literacy rate is not great. Most of the other state's literacy rate \n### follow the same trend as sex ratio and FEMALE literacy rate.This implies where there is good amount of \n### female population there is good amount of female education and good amount of literacy also and the vice versa.\n### Female literacy is maximum in Kerala which is more than male literacy rate also in the state.","execution_count":null,"outputs":[]},{"metadata":{"_execution_state":"idle","_uuid":"5cd88b2303d45ac3aa04001a45b9469e9268b774","trusted":true,"_cell_guid":"fca054f6-f382-4b84-b071-0da750e2bcc1"},"cell_type":"code","source":"## It is important to see how the sex ratio and literacy rate affects the graduation rate ##\n## Get the data of graduation rate and sex ratio for state #\nsex_ratio_vs_graduation_rate_data <- melt(state_df[, c(\"state_name\", \n                                                     \"state_sex_ratio\",\n                                                     \"total_graduation_rate\", \n                                                     \"male_graduation_rate\", \n                                                     \"female_graduation_rate\")], \n                                        id=\"state_name\")\n\n### plot the total graduation rate across states ###\nggplot(sex_ratio_vs_graduation_rate_data[sex_ratio_vs_graduation_rate_data$variable==\"total_graduation_rate\",], \n       aes(reorder(state_name, value, desc), value, fill=state_name)) + geom_bar(stat = \"identity\") +\n  theme(axis.text.x = element_text(angle=90,hjust=1), legend.position = \"none\") + \n  geom_text(aes(label=value), angle=90, hjust=0) +\n  labs(x= \"States\", y=\"Graduation Rate\", title = \"Graduation Rate across States\", caption=paste(\"Over All Graduation Rate is\", round((sum(state_df$graduates_total)/sum(state_df$total_population))*100,2)))\n\n### Clearly Himachal Pradesh has the highest graduation rate and NCT of Delhi has the lowest. We can also observe that total graduation\n### rate is around 13% only. The maximum graduating population is mearly 25%. This shows that employable people at executive level are \n### very less.\n\n### Bring the sex ratio to a comparable value ###\nsex_ratio_vs_graduation_rate_data[sex_ratio_vs_graduation_rate_data$variable==\"state_sex_ratio\",]$value <-\n  sex_ratio_vs_graduation_rate_data[sex_ratio_vs_graduation_rate_data$variable==\"state_sex_ratio\",]$value/100\n\n\n### plot the total graduation rate across states ###\nggplot(sex_ratio_vs_graduation_rate_data, aes(state_name, value, col=variable)) + geom_point() + \ngeom_line(aes(group=variable)) + theme(axis.text.x = element_text(angle=90,hjust=1), legend.position = \"bottom\") + \n  labs(x= \"States\", y=\"Graduation Rate\", title = \"Graduation Rate across States\", \n       caption=paste(\"Over All Graduation Rate is\", \n                     round((sum(state_df$graduates_total)/sum(state_df$total_population))*100,2)))\n### Interestingly the total population, male and female graduation rate is equal for Himachal Pradesh and that is highest for total and female population\n### The maximum graduation rate for females is in Manipur which has the second highest total graduation rate. Lowest graduation rate for male is in NCT of\n### Delhi where as lowest graduation rate for female is in Bihar.\n\n### sex Ratio doesn't seems to be affecting the graduation rate much. ###\n\n## Lets Plot the literacy rate with graduation rate ##\n### filter gradutaion rate data with effective literacy rate ###\nliteracy_rate_vs_graduation_rate_data <- melt(state_df[, c(\"state_name\", \n                                                       \"effective_literacy_rate\",\n                                                       \"total_graduation_rate\", \n                                                       \"male_graduation_rate\", \n                                                       \"female_graduation_rate\")], \n                                          id=\"state_name\")\n### plot graph for graduation rate along with literacy rate ###\nggplot(literacy_rate_vs_graduation_rate_data, aes(state_name, value, col=variable)) + \ngeom_line(aes(group=variable)) + geom_point() + \ntheme(axis.text.x = element_text(angle=90,hjust=1), legend.position = \"bottom\") + \n  labs(x= \"States\", y=\"Graduation Rate\", title = \"Graduation Rate across States\")\n### from the results the literacy rate seems to be affecting the graduation rate but it doesn't look too \n### strong.","execution_count":null,"outputs":[]},{"metadata":{"_execution_state":"idle","_uuid":"a10014a3b79ed5e6f444014cd96c326b656cd737","trusted":true,"_cell_guid":"e33264c5-2443-4cbd-92cc-103aa464e520"},"cell_type":"code","source":"## Some graphs showing relation between two variables ##\n\nggplot(city_data, aes(sex_ratio, child_sex_ratio)) + geom_point() + geom_smooth() +\n   labs(x=\"Sex Ratio\", y=\"Child Sex Ratio\", title=\"Sex Ratio Vs. Child Sex Ratio\")\n\nggplot(city_data, aes(sex_ratio, effective_literacy_rate_total)) + geom_point() + geom_smooth() +\n   labs(x=\"Sex Ratio\", y=\"Effective Literacy Rate\", title=\"Sex Ratio Vs. Effective Literacy Rate\")\n\nggplot(city_data, aes(sex_ratio, total_graduates*100/population_total)) + geom_point() + geom_smooth() +\n  labs(x=\"Sex Ratio\", y=\"Graduation Rate\", title=\"Sex Ratio Vs. Graduation Rate\")\n\nggplot(city_data, aes(effective_literacy_rate_total, total_graduates*100/population_total)) + geom_point() + geom_smooth() +\n  labs(x=\"Literacy Rate\", y=\"Graduation Rate\", title=\"Literacy Rate  Vs. Graduation Rate\")","execution_count":null,"outputs":[]},{"metadata":{"_execution_state":"idle","_uuid":"d70a8d043bc9bcfa662c71a9a910a0caa17972a2","trusted":true,"_cell_guid":"06ae7d62-06eb-4e25-90b9-a72adb51473c"},"cell_type":"code","source":"## Finding correlation between the numeric variables ##\ncity_num_data <- city_data[,!(colnames(city_data) %in% c(\"name_of_city\",\"state_code\", \"state_name\", \"dist_code\", \"location\"))]\ncordata <- cor(city_num_data)\ncorrplot(cordata, method=\"shade\", type=\"upper\")","execution_count":8,"outputs":[]},{"metadata":{"scrolled":true,"_uuid":"f18bf5fbfd16d4bb2b2b3018040cb0786ab93ed0","trusted":true,"_cell_guid":"b8a1ba26-14f7-4003-9663-053256cea6c3"},"cell_type":"code","source":"#name_of_city' 'state_code' 'state_name' 'dist_code' 'population_total' 'population_male' 'population_female' 'X0.6_population_total' 'X0.6_population_male' 'X0.6_population_female' \n#'literates_total' 'literates_male' 'literates_female' 'sex_ratio' 'child_sex_ratio' 'effective_literacy_rate_total' 'effective_literacy_rate_male' 'effective_literacy_rate_female' \n#'location' 'total_graduates' 'male_graduates' 'female_graduates'\n\noperate_on <- city_data\n#operates_on <- operate_on[,!(colnames(city_data) %in% c(\"name_of_city\", \"state_code\", \"state_name\", \"dist_code\", \"location\"))]\n#Population based clustering for adults\noperates_on <- operate_on[,colnames(city_data) %in% c(\"sex_ratio\", \"effective_literacy_rate_total\")]\nstr(operates_on)\nscaled_df <- scale(operates_on)\ndist_df <- dist(scaled_df)\nstr(dist_df)\n#scale_df <- cbind(city_data[,c(1,2,3,4)], scale_df)\n#dist_df <- dist(scale_df)\nsum(is.na(dist_df))\n\ntest <- as.data.frame(sapply(operates_on$location, function(x) strsplit(x,',')))\ntest <- t(test)\noperates_on <- cbind(operates_on, test)\n\ncolnames(operates_on)[25] <-\"longitude\"\ncolnames(operates_on)[26] <- \"latitude\"\nstr(operates_on)\noperates_on$longitude <- as.numeric(operates_on$longitude)\noperates_on$latitude <- as.numeric(as.character(operates_on$latitude))","execution_count":112,"outputs":[]},{"metadata":{"_uuid":"aeb764b574f53229a44324d3b4e2e05f09bf66c2","trusted":true,"_cell_guid":"9dc49bec-8fe4-4367-ab82-8307ff693971"},"cell_type":"code","source":"hcl <- hclust(dist_df, method = \"ward.D2\")\nplot(hcl)\nrect.hclust(hcl, k=5, border=\"red\")\n\n## Making the cut in the dendrogram\n\nclusterCut <- cutree(hcl, k=5)\noperates_on <- cbind(city_data,clusterCut)\n\ncluster_level_output <- operates_on %>% group_by(clusterCut) %>% summarise(total_cities = n(),\n                                                                           total_population = mean(population_total),\n                                                                           sex_ratio = mean(sex_ratio),\n                                                                           effective_literacy_rate = mean(effective_literacy_rate_total))  %>% arrange(desc(total_population))\n#Doesn't work properly for complete method but works for ward D2","execution_count":86,"outputs":[]},{"metadata":{"trusted":true,"_uuid":"985da04cd7a88a1000477b13673321e0495f4acb"},"cell_type":"code","source":"cluster_level_output","execution_count":11,"outputs":[]},{"metadata":{"trusted":true,"_uuid":"99d184b4d59c67f6f3afff2b9b5ec6716ddfbd48"},"cell_type":"code","source":"#Plots of the output\nggplot(operates_on, aes(effective_literacy_rate_total, sex_ratio, col=as.factor(clusterCut))) + geom_point() + \ngeom_text(aes(label=name_of_city), stat = \"identity\", hjust=0)\n\nggplot(cluster_level_output, aes(clusterCut, total_population, fill=as.factor(clusterCut))) + geom_bar(stat=\"identity\")\nggplot(cluster_level_output, aes(clusterCut, sex_ratio, fill=as.factor(clusterCut))) + geom_bar(stat=\"identity\")\nggplot(cluster_level_output, aes(clusterCut, effective_literacy_rate, fill=as.factor(clusterCut))) + geom_bar(stat=\"identity\")","execution_count":87,"outputs":[]},{"metadata":{"scrolled":false,"_uuid":"85590aed0579dcf33c29cbc3523c2044767fb434","trusted":true,"_cell_guid":"a73bc8b0-3cd2-4dbe-a2c6-3db401b01b34"},"cell_type":"code","source":"r_sq <- vector()\nfor (number in 1:20){clus <- kmeans(scaled_df, centers = number, nstart = 50, iter.max = 50)\nr_sq[number]<- clus$betweenss/clus$totss\n}\nggplot() + geom_point(aes(1:20, r_sq))\n#The elbow curve can be obtrained at 5 or 6\n\nKM_Clus <- kmeans(scaled_df, centers = 5, nstart = 50, iter.max = 50)\noperates_on <- cbind(operates_on, kclus=KM_Clus$cluster)","execution_count":88,"outputs":[]},{"metadata":{"trusted":true,"_uuid":"ec89f12a082b78b9f4782fc74b887cc24ad143ba"},"cell_type":"code","source":"cluster_level_output <- operates_on %>% group_by(kclus) %>% summarise(total_cities = n(),\n                                                                           total_population = mean(population_total),\n                                                                           sex_ratio = mean(sex_ratio),\n                                                                           effective_literacy_rate = mean(effective_literacy_rate_total),\n                                                                     total_literates = mean(literates_total))  %>% arrange(desc(total_population))\ncluster_level_output","execution_count":89,"outputs":[]},{"metadata":{"trusted":true,"_uuid":"b48c542f8cd1f6274720ff076fb9d36b65588a5f"},"cell_type":"code","source":"ggplot(operates_on, aes(effective_literacy_rate_total, sex_ratio, col=as.factor(kclus))) + geom_point() + \ngeom_text(aes(label=name_of_city), stat = \"identity\", hjust=0)\n\nggplot(cluster_level_output, aes(kclus, total_population, fill=as.factor(kclus))) + geom_bar(stat=\"identity\")\nggplot(cluster_level_output, aes(kclus, sex_ratio, fill=as.factor(kclus))) + geom_bar(stat=\"identity\")\nggplot(cluster_level_output, aes(kclus, effective_literacy_rate, fill=as.factor(kclus))) + geom_bar(stat=\"identity\")","execution_count":90,"outputs":[]}],"metadata":{"kernelspec":{"display_name":"R","language":"R","name":"ir"},"language_info":{"mimetype":"text/x-r-source","name":"R","pygments_lexer":"r","version":"3.4.2","file_extension":".r","codemirror_mode":"r"}},"nbformat":4,"nbformat_minor":1}